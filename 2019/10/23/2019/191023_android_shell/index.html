<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <link rel="canonical" href="true/2019/10/23/2019/191023_android_shell/">
    
    
    <title>Android Shell脚本应用 | sunwengang blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="shell">
    <meta name="description" content="基本结构.sh（系统中文.ch.sh）#!&#x2F;bin&#x2F;bash 脚本开头 #!&#x2F;bin&#x2F;csh 是 C shell 的命令解">
<meta property="og:type" content="article">
<meta property="og:title" content="Android Shell脚本应用">
<meta property="og:url" content="http://wizzie.top/2019/10/23/2019/191023_android_shell/index.html">
<meta property="og:site_name" content="sunwengang blog">
<meta property="og:description" content="基本结构.sh（系统中文.ch.sh）#!&#x2F;bin&#x2F;bash 脚本开头 #!&#x2F;bin&#x2F;csh 是 C shell 的命令解">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-10-23T15:52:00.000Z">
<meta property="article:modified_time" content="2020-03-08T10:17:25.211Z">
<meta property="article:author" content="sunwengang">
<meta property="article:tag" content="shell">
<meta name="twitter:card" content="summary">
    
        <link rel="alternate" type="application/atom+xml" title="sunwengang blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">sunwengang</h5>
          <a href="mailto:1332963488@qq.com" title="1332963488@qq.com" class="mail">1332963488@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                Home
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.cnblogs.com/1996swg" target="_blank" >
                <i class="icon icon-lg icon-book"></i>
                cnblog
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/AloneAlive" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/html/nav.html" target="_blank" >
                <i class="icon icon-lg icon-external-link-square"></i>
                nav
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/others"  >
                <i class="icon icon-lg icon-address-book"></i>
                friends
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Android Shell脚本应用</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Android Shell脚本应用</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-10-23T15:52:00.000Z" itemprop="datePublished" class="page-time">
  2019-10-23
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/android/">android</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#基本结构-sh（系统中文-ch-sh）"><span class="post-toc-number">1.</span> <span class="post-toc-text">基本结构.sh（系统中文.ch.sh）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#export"><span class="post-toc-number">2.</span> <span class="post-toc-text">export</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#用语句给变量赋值，如将-etc下目录的文件名循环出来"><span class="post-toc-number">3.</span> <span class="post-toc-text">用语句给变量赋值，如将&#x2F;etc下目录的文件名循环出来</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#、-0、-1、-2"><span class="post-toc-number">4.</span> <span class="post-toc-text">$、$0、$1、$2..</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#ps-ef-grep-surfaceFlinger-awk-‘-print-2-’的含义"><span class="post-toc-number">5.</span> <span class="post-toc-text">ps -ef |grep surfaceFlinger |awk ‘{print $2}’的含义</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#两种方式声明函数"><span class="post-toc-number">6.</span> <span class="post-toc-text">两种方式声明函数</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#while-语句"><span class="post-toc-number">7.</span> <span class="post-toc-text">while 语句</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#android-serial-adb-shell-getprop-“re-serialno”-获取设备序列号"><span class="post-toc-number">8.</span> <span class="post-toc-text">$android_serial&#x3D;$(adb shell getprop “re.serialno”)获取设备序列号</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#adb-shell-input-swipe-359-1600-359-340-500"><span class="post-toc-number">9.</span> <span class="post-toc-text">adb shell input swipe 359 1600 359 340 500</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#if-ps-ef-grep-c-quot-ssh-quot-gt-1-then-echo-quot-true-quot-fi（适合中断，写成一行）"><span class="post-toc-number">10.</span> <span class="post-toc-text">if [ $(ps -ef | grep -c &quot;ssh&quot;) -gt 1 ]; then echo &quot;true&quot;; fi（适合中断，写成一行）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#sed-i-‘s-15-g’-tmp-txt"><span class="post-toc-number">11.</span> <span class="post-toc-text">sed -i ‘s&#x2F;^.\{15\}&#x2F;&#x2F;g’ tmp.txt</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#sed-i就是直接对文本文件进行操作"><span class="post-toc-number">11.1.</span> <span class="post-toc-text">sed -i就是直接对文本文件进行操作</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#正则"><span class="post-toc-number">11.2.</span> <span class="post-toc-text">正则</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#sed"><span class="post-toc-number">11.3.</span> <span class="post-toc-text">sed</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#多选择语句case"><span class="post-toc-number">12.</span> <span class="post-toc-text">多选择语句case</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#adb-shell-pidof-”mediaserver“"><span class="post-toc-number">13.</span> <span class="post-toc-text">adb shell pidof ”mediaserver“</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#adb-shell-am-start-n"><span class="post-toc-number">14.</span> <span class="post-toc-text">adb shell am start -n</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#adb-shell-input-tap-x-y"><span class="post-toc-number">15.</span> <span class="post-toc-text">adb shell input tap x y</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#adb-shell-dumpsys-window-windows-grep-Current-tee-tmp-txt"><span class="post-toc-number">16.</span> <span class="post-toc-text">adb shell dumpsys window windows |grep Current |tee tmp.txt</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#date-Y-m-d-H-M-S输出日期"><span class="post-toc-number">17.</span> <span class="post-toc-text">date + %Y%m%d_%H%M%S输出日期</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#date-N-cut-c-3"><span class="post-toc-number">18.</span> <span class="post-toc-text">date + %N | cut -c -3</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#cat-systrace-html-grep-postComp-wc-l"><span class="post-toc-number">19.</span> <span class="post-toc-text">cat **systrace.html |grep postComp |wc -l</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#（视频播放时）旋转屏幕"><span class="post-toc-number">20.</span> <span class="post-toc-text">（视频播放时）旋转屏幕</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#shell判断数组中是否包含某个元素"><span class="post-toc-number">21.</span> <span class="post-toc-text">shell判断数组中是否包含某个元素</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#解决播放结束后，判断当前activity然后重新播放"><span class="post-toc-number">22.</span> <span class="post-toc-text">解决播放结束后，判断当前activity然后重新播放</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#包含关系"><span class="post-toc-number">23.</span> <span class="post-toc-text">包含关系</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#查找手机文件"><span class="post-toc-number">24.</span> <span class="post-toc-text">查找手机文件</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#播放视频"><span class="post-toc-number">25.</span> <span class="post-toc-text">播放视频</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#逐行读某个文件"><span class="post-toc-number">26.</span> <span class="post-toc-text">逐行读某个文件</span></a></li></ol>
        </nav>
    </aside>


<article id="post-2019/191023_android_shell"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Android Shell脚本应用</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-10-23 23:52:00" datetime="2019-10-23T15:52:00.000Z"  itemprop="datePublished">2019-10-23</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/android/">android</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="基本结构-sh（系统中文-ch-sh）"><a href="#基本结构-sh（系统中文-ch-sh）" class="headerlink" title="基本结构.sh（系统中文.ch.sh）"></a>基本结构.sh（系统中文.ch.sh）</h2><p><code>#!/bin/bash</code> 脚本开头</p>
<p><code>#!/bin/csh</code> 是 C shell 的命令解</p>
<a id="more"></a>

<h2 id="export"><a href="#export" class="headerlink" title="export"></a>export</h2><blockquote>
<p>功能说明：设置或显示环境变量。<br>语　　法：export [-fnp][变量名称]=[变量设置值]<br>补充说明：在 shell 中执行程序时，shell 会提供一组环境变量。export 可新增，修改或删除环境变量，供后续执行的程序使用。export 的效力仅限于该次登陆操作。</p>
</blockquote>
<ol>
<li>用户登录到Linux系统后，系统将启动一个用户shell。在这个shell中，可以使用shell命令或声明变量，也可以创建并运行 shell 脚本程序。</li>
<li>运行shell脚本程序时，系统将创建一个子shell。此时，系统中将有两个shell，一个是登录时系统启动的 shell，另一个是系统为运行脚本程序创建的shell。</li>
<li>当一个脚本程序运行完毕，脚本shell将终止，返回到执行该脚本之前的shell。从这种意义上来说，用户可以有许多shell，每个shell都是由某个 shell（称为父 shell）派生的。</li>
<li>在子shell中定义的变量只在该子shell内有效。</li>
<li>如果在一个shell脚本程序中定义了一个变量，当该脚本程序运行时，这个定义的变量只是该脚本程序内的一个局部变量，其他的 shell 不能引用它，要使某个变量的值可以在其他 shell 中被改变，可以使用 export 命令对已定义的变量进行输出。</li>
<li>export命令将使系统在创建每一个新的shell时，定义这个变量的一个拷贝。这个过程称之为变量输出。</li>
</ol>
<h2 id="用语句给变量赋值，如将-etc下目录的文件名循环出来"><a href="#用语句给变量赋值，如将-etc下目录的文件名循环出来" class="headerlink" title="用语句给变量赋值，如将/etc下目录的文件名循环出来"></a>用语句给变量赋值，如将<code>/etc</code>下目录的文件名循环出来</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for file in `ls /etc`</span><br><span class="line">或</span><br><span class="line">for file in $(ls /et)</span><br></pre></td></tr></table></figure>

<p>使用<code>$</code>符号来取一个变量的值，常见的就是<code>$VAR</code></p>
<p>变量定义：<code>app_name=”test”</code></p>
<h2 id="、-0、-1、-2"><a href="#、-0、-1、-2" class="headerlink" title="$、$0、$1、$2.."></a><code>$、$0、$1、$2..</code></h2><p><code>$0</code>就是你写的shell脚本本身的名字，<code>$1</code>是你给你写的shell脚本传的第一个参数，<code>$2</code>是你给你写的shell脚本传的第二个参数。</p>
<h2 id="ps-ef-grep-surfaceFlinger-awk-‘-print-2-’的含义"><a href="#ps-ef-grep-surfaceFlinger-awk-‘-print-2-’的含义" class="headerlink" title="ps -ef |grep surfaceFlinger |awk ‘{print $2}’的含义"></a><code>ps -ef |grep surfaceFlinger |awk ‘{print $2}’</code>的含义</h2><ul>
<li><code>$2</code>：表示第二个字段</li>
<li><code>print $2</code>：打印第二个字段</li>
<li><code>-e</code>: 显示所有进程。</li>
<li><code>-f</code>:全格式</li>
<li><code>awk &#39;{print $2}&#39; $fileName</code>: 一行一行的读取指定的文件， 以空格作为分隔符，打印每行的第二个字段（即 pid）。</li>
<li><code>ps</code>: 打印的信息：</li>
<li>字段含义如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UID PID PPID C STIME TTY TIME CMD</span><br><span class="line">zzw 14124 13991 0 00:38 pts&#x2F;0 00:00:00 grep --color&#x3D;auto dae</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="两种方式声明函数"><a href="#两种方式声明函数" class="headerlink" title="两种方式声明函数"></a>两种方式声明函数</h2><ol>
<li>”function”不可以省略(建议)<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">function find &#123; ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>不得添加参数<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find() &#123; ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>两种声明方式效果等价。<br><strong>注意：</strong><br>（1）函数名和”{“之间必须有空格；<br>（2）不得声明形式参数；<br>（3）必须在调用前声明；<br>（4）无法重载；<br>（5）后来的声明会覆盖之前的声明</p>
<h2 id="while-语句"><a href="#while-语句" class="headerlink" title="while 语句"></a>while 语句</h2><p><code>while</code>循环用于不断执行一系列命令，也用于从输入文件中读取数据；命令通常为测试条件。其格式为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while condition</span><br><span class="line">do</span><br><span class="line">    command</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p>以下是一个基本的while循环，测试条件是：如果int小于等于5，那么条件返回真。int从0开始，每次循环处理时，<code>int</code>加1运行上述脚本，返回数字1到5，然后终止。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">int=1</span><br><span class="line">while(( $int&lt;=5 ))</span><br><span class="line">do</span><br><span class="line">    echo $int</span><br><span class="line">    let "int++"</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<h2 id="android-serial-adb-shell-getprop-“re-serialno”-获取设备序列号"><a href="#android-serial-adb-shell-getprop-“re-serialno”-获取设备序列号" class="headerlink" title="$android_serial=$(adb shell getprop “re.serialno”)获取设备序列号"></a><code>$android_serial=$(adb shell getprop “re.serialno”)</code>获取设备序列号</h2><h2 id="adb-shell-input-swipe-359-1600-359-340-500"><a href="#adb-shell-input-swipe-359-1600-359-340-500" class="headerlink" title="adb shell input swipe 359 1600 359 340 500"></a><code>adb shell input swipe 359 1600 359 340 500</code></h2><p><code>input</code>后可以跟很多参数，text相当于输入内容，keyevent相当于手机物理或是屏幕按键，tap相当于touch事件，<code>swipe</code>相当于滑动。<br><code>input/swipe</code>模拟的是滑动事件，<code>input swipe &lt;x1&gt; &lt;y1&gt; &lt;x2&gt; &lt;y2&gt; [duration(ms)] (Default: touchscreen)</code>，需要将起始的坐标传进去。</p>
<ul>
<li>向左滑动：<br><code>shell@lentk6735_66t_l1:/ $ input swipe 600 800 300 800</code></li>
<li>向右滑动：<br><code>shell@lentk6735_66t_l1:/ $ input swipe 300 800 600 800</code></li>
<li>滑动：<br><code>adb shell input swipe 100 100 200 200 300 //从 100 100 经历 300 毫秒滑动到 200 200</code></li>
<li>长按：<br><code>adb shell input swipe 100 100 100 100 1000 //在 100 100 位置长按 1000 毫秒</code></li>
</ul>
<h2 id="if-ps-ef-grep-c-quot-ssh-quot-gt-1-then-echo-quot-true-quot-fi（适合中断，写成一行）"><a href="#if-ps-ef-grep-c-quot-ssh-quot-gt-1-then-echo-quot-true-quot-fi（适合中断，写成一行）" class="headerlink" title="if [ $(ps -ef | grep -c &quot;ssh&quot;) -gt 1 ]; then echo &quot;true&quot;; fi（适合中断，写成一行）"></a><code>if [ $(ps -ef | grep -c &quot;ssh&quot;) -gt 1 ]; then echo &quot;true&quot;; fi（适合中断，写成一行）</code></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if condition</span><br><span class="line">then</span><br><span class="line"> command1 </span><br><span class="line"> command2</span><br><span class="line"> ...</span><br><span class="line"> commandN</span><br><span class="line">else</span><br><span class="line"> command</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-eq</code>:等于</li>
<li><code>-ne</code>:不等于</li>
<li><code>-le</code>:小于等于</li>
<li><code>-ge</code>:大于等于</li>
<li><code>-lt</code>:小于</li>
<li><code>-gt</code>：大于</li>
<li><code>-a</code>: 双方都成立（and） 逻辑表达式 –a 逻辑表达式</li>
<li><code>-o</code>: 单方成立（or） 逻辑表达式 –o 逻辑表达式</li>
</ul>
<h2 id="sed-i-‘s-15-g’-tmp-txt"><a href="#sed-i-‘s-15-g’-tmp-txt" class="headerlink" title="sed -i ‘s/^.\{15\}//g’ tmp.txt"></a><code>sed -i ‘s/^.\{15\}//g’ tmp.txt</code></h2><p><code>adb shell wm size &gt; tmp.txt</code> //分辨率导出文件</p>
<p><code>sed -i ‘s/^.\{15\}//g’ tmp.txt</code> //此处 <code>\{</code>是转义成 `{</p>
<p><code>wm_size=$(cat tmp.txt)</code></p>
<h3 id="sed-i就是直接对文本文件进行操作"><a href="#sed-i就是直接对文本文件进行操作" class="headerlink" title="sed -i就是直接对文本文件进行操作"></a><code>sed -i</code>就是直接对文本文件进行操作</h3><p><code>sed -i &#39;s/原字符串/新字符串/&#39; /home/1.txt</code></p>
<p><code>sed -i &#39;s/原字符串/新字符串/g&#39; /home/1.txt</code></p>
<h3 id="正则"><a href="#正则" class="headerlink" title="正则"></a>正则</h3><ul>
<li><code>^</code>: 匹配输入字符串的开始位置。如果设置了<code>RegExp</code>对象的<code>Multiline</code>属性，<code>^</code>也匹配<code>\n</code>或<code>\r</code>之后的位置。</li>
<li><code>.</code>: 匹配除“\n”之外的任何单个字符。要匹配包括“\n”在内的任何字符，请使用像“(.|\n)”的模式。</li>
<li><code>\</code>: 将下一个字符标记为一个特殊字符、或一个原义字符、或一个向后引用、或一个八进制转义符。例如，<code>n</code>匹配字符<code>n</code>。<code>\n</code>匹配一个换行符。串行<code>\\</code>匹配<code>\</code>而<code>\(</code>则匹配<code>(</code>。</li>
<li><code>{n}</code>:n是一个非负整数。匹配确定的n次。例如，<code>o{2}</code>不能匹配<code>Bob</code>中的<code>o</code>，但是能匹配<code>food</code>中的两个<code>o</code>。</li>
</ul>
<h3 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h3><ul>
<li><code>-n</code>：只打印模式匹配的行</li>
<li><code>-e</code>：直接在命令行模式上进行 sed 动作编辑，此为默认选项</li>
<li><code>-f</code>：将 sed 的动作写在一个文件内，用–f filename 执行 filename 内的 sed 动作</li>
<li><code>-r</code>：支持扩展表达式（配合正则表达式）</li>
<li><code>-i</code>：直接修改文件内容</li>
</ul>
<p>例如：</p>
<ul>
<li>删除该行的第一个字符：<code>sed -r &#39;s/^.//g&#39; &lt;&lt;&lt; $line</code></li>
<li>删除文件每行的第二个字符: <code>sed -r &#39;s/^(.)(.)/\2/g&#39; passwd</code></li>
<li>删除文件每行的倒数第二个字符: <code>sed -r &#39;s/(.)(.)$/\2/g&#39; passwd</code></li>
<li>交换每行的第一个字符和第二个字符:<code>sed -r &#39;s/^(.)(.)/\2\1/g&#39; passwd</code></li>
<li>交换每行的第一个单词和最后一个单词:<code>sed -r &#39;s/^([a-Z0-9]+)([^a-Z0-9]+)(.+)([^a-Z0-9]+)([a-Z0-9]+)/\5\2\3\4\1/g&#39; passwd</code></li>
</ul>
<h2 id="多选择语句case"><a href="#多选择语句case" class="headerlink" title="多选择语句case"></a>多选择语句<code>case</code></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">echo '你输入的数字为:'</span><br><span class="line">read aNum</span><br><span class="line">case $aNum in</span><br><span class="line">    1) echo '你选择了 1'</span><br><span class="line">    ;;</span><br><span class="line">    2) echo '你选择了 2'</span><br><span class="line">    ;;</span><br><span class="line">    3) echo '你选择了 3'</span><br><span class="line">    ;;</span><br><span class="line">    4) echo '你选择了 4'</span><br><span class="line">    ;;</span><br><span class="line">    *) echo '你没有输入 1 到 4 之间的数字'</span><br><span class="line">    ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>

<h2 id="adb-shell-pidof-”mediaserver“"><a href="#adb-shell-pidof-”mediaserver“" class="headerlink" title="adb shell pidof ”mediaserver“"></a><code>adb shell pidof ”mediaserver“</code></h2><p>按名称检查正在运行的进程，可以使用<code>pidof</code>命令：<code>adb shell pidof com.android.phone</code></p>
<p>如果找到此类进程，则返回<code>PID</code>,否则返回空字符串。</p>
<h2 id="adb-shell-am-start-n"><a href="#adb-shell-am-start-n" class="headerlink" title="adb shell am start -n"></a><code>adb shell am start -n</code></h2><p><code>adb shell am start -n com.android.camera...</code> //使用组件名方式启动照相机功能</p>
<p>可以使用<code>adb shell activity|grep ACTIVITY</code> 或者<code>dump SF</code>获取Activity名称</p>
<h2 id="adb-shell-input-tap-x-y"><a href="#adb-shell-input-tap-x-y" class="headerlink" title="adb shell input tap x y"></a><code>adb shell input tap x y</code></h2><p>模拟点击事件（点击屏幕），可以用来进入清除任务。</p>
<h2 id="adb-shell-dumpsys-window-windows-grep-Current-tee-tmp-txt"><a href="#adb-shell-dumpsys-window-windows-grep-Current-tee-tmp-txt" class="headerlink" title="adb shell dumpsys window windows |grep Current |tee tmp.txt"></a><code>adb shell dumpsys window windows |grep Current |tee tmp.txt</code></h2><p><strong>实现功能：</strong></p>
<ul>
<li><p>获得当前活动窗口的信息，包名以及活动窗体。</p>
</li>
<li><p>过滤<code>Current</code>信息，获得<code>window</code>的<code>dump</code>信息。</p>
</li>
<li><p><code>|tee</code>的作用：输出到控制台</p>
</li>
</ul>
<hr>
<h2 id="date-Y-m-d-H-M-S输出日期"><a href="#date-Y-m-d-H-M-S输出日期" class="headerlink" title="date + %Y%m%d_%H%M%S输出日期"></a><code>date + %Y%m%d_%H%M%S</code>输出日期</h2><p>输入格式：20181128_174323</p>
<h2 id="date-N-cut-c-3"><a href="#date-N-cut-c-3" class="headerlink" title="date + %N | cut -c -3"></a><code>date + %N | cut -c -3</code></h2><p><code>%N</code>: 纳秒</p>
<p><code>cut</code>： 从指定的范围中提取字节（-b）、或字符（-c）、或字段（-f）</p>
<ul>
<li><code>cut -b -3</code>//-3 表示从第一个字节到第三个字节</li>
<li><code>cut -b 3-</code>//3-表示从第三个字节到行尾</li>
<li><code>cut -b -3,3-</code> //输出整行，不会出现连续两个重叠的</li>
</ul>
<h2 id="cat-systrace-html-grep-postComp-wc-l"><a href="#cat-systrace-html-grep-postComp-wc-l" class="headerlink" title="cat **systrace.html |grep postComp |wc -l"></a><code>cat **systrace.html |grep postComp |wc -l</code></h2><p> <code>（linux 命令）WC</code>：<code>wc - print newline, word, and byte counts for each file</code></p>
<p>参数及含义：</p>
<ul>
<li><code>-c</code>: print the byte counts 统计字节数</li>
<li><code>-l</code>: print the newline counts：统计行数</li>
<li><code>-m</code>: print the character counts：将每个文件的字符数及文件名输出到屏幕上，如果当前系统不支持多字节字符其将显示与-c 参数相同的结果</li>
<li><code>-w</code>: print the word counts：统计字数</li>
</ul>
<h2 id="（视频播放时）旋转屏幕"><a href="#（视频播放时）旋转屏幕" class="headerlink" title="（视频播放时）旋转屏幕"></a>（视频播放时）旋转屏幕</h2><p><code>adb shell settings put system user_rotation 1</code>  //获取参数是get</p>
<h2 id="shell判断数组中是否包含某个元素"><a href="#shell判断数组中是否包含某个元素" class="headerlink" title="shell判断数组中是否包含某个元素"></a>shell判断数组中是否包含某个元素</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ary=(1 2 3)</span><br><span class="line">a=2</span><br><span class="line">if [[ "$&#123;ary[@]&#125;" =~ "$a" ]] ; then</span><br><span class="line"> echo "a in ary"</span><br><span class="line">else</span><br><span class="line"> echo "a not in ary"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<h2 id="解决播放结束后，判断当前activity然后重新播放"><a href="#解决播放结束后，判断当前activity然后重新播放" class="headerlink" title="解决播放结束后，判断当前activity然后重新播放"></a>解决播放结束后，判断当前activity然后重新播放</h2><ul>
<li><code>adb shell dumpsys activity top | grep &quot;ACTIVITY&quot;</code> //获得当前的 activity</li>
<li><code>adb shell am start -n com.home...</code> //返回桌面 activity</li>
</ul>
<h2 id="包含关系"><a href="#包含关系" class="headerlink" title="包含关系"></a>包含关系</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">testPlay=$(adb shell dumpsys activity top | grep "ACTIVITY")testPlaySuccess="com...Activity"</span><br><span class="line">                if [[ $testPlay =~ $testPlaySuccess ]];then</span><br><span class="line">                        echo "包含"</span><br><span class="line">                else</span><br><span class="line">                        echo "不包含"</span><br><span class="line">                fi</span><br></pre></td></tr></table></figure>

<h2 id="查找手机文件"><a href="#查找手机文件" class="headerlink" title="查找手机文件"></a>查找手机文件</h2><p><code>adb shell find /storage -name &quot;*.mp4&quot; | grep FileName</code></p>
<h2 id="播放视频"><a href="#播放视频" class="headerlink" title="播放视频"></a>播放视频</h2><p><code>adb shell am start -a android.intent.action.VIEW -d &quot;file:///storage/...../Test.mp4&quot; -t &quot;video/&quot;</code></p>
<h2 id="逐行读某个文件"><a href="#逐行读某个文件" class="headerlink" title="逐行读某个文件"></a>逐行读某个文件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while read line</span><br><span class="line">do</span><br><span class="line">…</span><br><span class="line">done &lt; file // `&lt;`是读，`&gt;`是写入，`&gt;&gt;`是写入到某个文件的末尾</span><br></pre></td></tr></table></figure>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2020-03-08T10:17:25.211Z" itemprop="dateUpdated">2020-03-08 18:17:25</time>
</span><br>


        
        版权声明:署名-非商用-相同方式共享 4.0 转载请保留原文链接及作者
        
    </div>
    
    <footer>
        <a href="http://wizzie.top">
            <img src="/img/avatar.jpg" alt="sunwengang">
            sunwengang
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/" rel="tag">shell</a></li></ul>


            


        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2019/11/03/2019/191103_android_hideDoc/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Android @hide接口注释</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2019/10/21/2019/191021_android_basis/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Android色彩空间（ColorSpace）</h4>
      </a>
    </div>
  
</nav>



    




















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        奥利给
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.png" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.png" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license noopener" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>sunwengang &copy; 2019 - 2020</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: false, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
